<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; connect-src https: wss:; script-src 'self'; style-src 'self'; object-src 'none';">
  <title>Chat Survivors Game Extension</title>
  <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="main.css">
</head>
<body>
  <div id="app">
    <section v-if="!isPlaying" class="login">
      <div v-if="needsPermission" class="permission">
        <span>Authorize the use of your name to play.</span>
        <button @click="requestAuthorization">Authorize</button>
      </div>
      <div v-else class="join">
        <span :style="{ color: nameColorStyle }">{{ username }}</span>
        <button @click="join">Enter game</button>
      </div>
    </section>

    <div v-else class="tabs-container">
      <nav>
        <button
          @click="tab = 'STATUS'"
          :class="{ selected: tab === 'STATUS' }"
          :style="{ color: nameColorStyle }">
          {{ username }}
        </button>
        <button
          @click="tab = 'INVENTORY'"
          :class="{ selected: tab === 'INVENTORY' }">
          Inventory
        </button>
      </nav>

      <section v-if="tab === 'STATUS'" class="status" :class="{ 'is-playing': isPlaying }">
        <label>Lv {{ level }}</label>

        <label class="bar">
          <div class="fill xp" :style="xpBarStyle"></div>
          <span>XP</span>
          <span>{{ experience }} / {{ experience_to_next_level }}</span>
          <span>XP</span>
        </label>

        <label class="bar">
          <div class="fill hp" :style="hpBarStyle"></div>
          <span>HP</span>
          <span>{{ hp.actual }} / {{ hp.max }}</span>
          <span>HP</span>
        </label>

        <label>Points {{ attributePoints }}</label>
        <div class="attributes">
          <div
            class="attribute"
            v-for="(value, attr, index) in attributes">
            <label
              class="attribute-label"
              :style="`--delay: ${index * 0.2}s`"
              :class="{ 'with-point': attributePoints === 1, 'with-points': attributePoints > 1 }">
              <span>{{ attr.slice(0, 3).toUpperCase() }}</span>
              <span></span>
              <span>{{ value }}</span>
            </label>
            <button
              class="upgrade-button"
              @click="upgradeAttribute(attr, true)"
              >+{{ attributePoints }}</button>
            <button
              class="upgrade-button one"
              @click="upgradeAttribute(attr)"
              >+1</button>
          </div>
        </div>
      </section>

      <section v-if="tab === 'INVENTORY'" class="inventory" :class="{ 'is-playing': isPlaying }">
        <div
          v-for="n in 48"
          :key="n"
          class="box">
        </div>
      </section>
    </div>
  </div>

  <script src="https://extension-files.twitch.tv/helper/v1/twitch-ext.min.js"></script>
  <script src="main.js"></script>
</body>
</html>
